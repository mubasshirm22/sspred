<html>
<head>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="font-family:monospace;">	
<b> Please enter a single sequence only, spaces will be automatically removed <br />
Error will occur if input contains non amino-acid letters <br/>
Support for FASTA formats will be added in the future</b>
<br/><br/><br/>
<div>
	{% block content %}
		<form method="POST" action=""> 
			{{ form.hidden_tag() }}
			{% if form.errors %}
    				<ul class="errors">
        				{% for field_name, field_errors in form.errors|dictsort if field_errors %}
            					{% for error in field_errors %}
                					<li> {{ error }}</li>
            					{% endfor %}
        				{% endfor %}
    				</ul>
			{% endif %}
			{{ form.seqtext.label }}
			<br>
			{{ form.seqtext(cols="50", rows="4") }}
			<br>
			<button id="clearbtn" type="button">Clear Sequence</button>
			<button id="genbtn" type="button">Generate Random Sequence</button>
			<br>
			{{ form.email.label }}
			{{ form.email }}
			<br>	
			<table onclick = "checkCount()">
				Send sequence to:
				<tr>
					<td>
						{{ form.JPred }}
						{{ form.JPred.label }}
					</td>
					<td>
						{{ form.PSI }}
						{{ form.PSI.label }}
					</td>
					<td>
						{{ form.PSS }}
						{{ form.PSS.label }}
					</td>
				</tr>
				<tr>
					<td>
						{{ form.RaptorX }}
						{{ form.RaptorX.label }}
					<td>
						{{ form.Sable }}
						{{ form.Sable.label }}
					</td>
					<td>
						{{ form.Yaspin }}
						{{ form.Yaspin.label }}
					</td>
				</tr>
				<tr>
					<td>
						{{ form.SSPro }}
						{{ form.SSPro.label }}
					</td>
				</tr>
			</table>
			{{ form.rowlength.label }}
			{{ form.rowlength(style="width:30px") }}
			<br>
			<table style="text-align: center; padding-left:20px; padding-bottom: 10px">
				Color Coding Options:
				<tr>
					<td>Helix</td>
					<td>Coil</td>
					<td>Beta</td>
				</tr>
				<tr>
					<td>{{ form.helixcolor }}</td>
					<td>{{ form.coilcolor }}</td>
					<td>{{ form.betacolor }}</td>
				</tr>
			</table>
			<div id = "colorCodeIE" style="display:none">
			Internet Explorer does not support color picking. To choose colors, either get a color code from 
				<a href="https://www.w3schools.com/colors/colors_picker.asp">here</a>
			or switch to a compatible browser such as Google Chrome or Mozilla Firefox.
			</div>
			<input type="reset">
			{{ form.submitbtn() }}
		</form>
	{% endblock  %}
</div>

Instances Running:
<br />&nbsp;&nbsp;&nbsp;&nbsp;PSI: {{counter.PSI}}
<br />&nbsp;Yaspin: {{counter.Yaspin}}
<br />&nbsp;&nbsp;&nbsp;&nbsp;PSS: {{counter.PSS}} (MAX 3)
<br />&nbsp;&nbsp;JPred: {{counter.JPred}}
<br />&nbsp;&nbsp;Sable: {{counter.Sable}}
<br />RaptorX: {{counter.RaptorX}}
<br />&nbsp;&nbsp;SSPro: {{counter.SSPro}} (MAX 5)
<br />


<div> 
-----------------------------------------------------------------------------------
<br />
<br />
<br />Upon submission, you will be redirected to a page showing your sequence 
<br />The page will reload every 30 seconds displaying results as they are completed
<br />
<br />Typical Wait Times for Sequence of 150 Residues  
<br />&nbsp;&nbsp;&nbsp;&nbsp;PSI: 1-7 minutes
<br />&nbsp;Yaspin: 1-3 minutes (Often offline)
<br />&nbsp;&nbsp;&nbsp;&nbsp;PSS: 1-3 minutes	(Currently broken)
<br />&nbsp;&nbsp;JPred: 3-5 minutes
<br />&nbsp;&nbsp;Sable: 5-7 minutes
<br />RaptorX: 5-7 minutes	
<br />&nbsp;&nbsp;SSPro: 8 minutes
<br />
<br />
<br />An email containing the final results will be sent to the address provided above
<br />
<br /><a href="/archive" target="_blank">All previously submitted results can be found by clicking here</a>
<br />
<br />
<br />Sites Used:
<br />&nbsp;&nbsp;&nbsp;&nbsp;PSI: <a href="http://bioinf.cs.ucl.ac.uk/psipred/">http://bioinf.cs.ucl.ac.uk/psipred/</a>
<br />&nbsp;Yaspin: <a href="http://www.ibi.vu.nl/programs/yaspinwww/">http://www.ibi.vu.nl/programs/yaspinwww/</a>
<br />&nbsp;&nbsp;&nbsp;&nbsp;PSS: <a href="https://zhanglab.ccmb.med.umich.edu/PSSpred/">https://zhanglab.ccmb.med.umich.edu/PSSpred/</a>
<br />&nbsp;&nbsp;JPred: <a href="http://www.compbio.dundee.ac.uk/jpred/">http://www.compbio.dundee.ac.uk/jpred/</a>
<br />&nbsp;&nbsp;Sable: <a href="https://sable.cchmc.org/">https://sable.cchmc.org/</a>
<br />RaptorX: <a href="http://raptorx.uchicago.edu/StructurePropertyPred/predict/">http://raptorx.uchicago.edu/StructurePropertyPred/predict/</a>	
<br />&nbsp;&nbsp;SSPro: <a href="http://scratch.proteomics.ics.uci.edu/index.html">http://scratch.proteomics.ics.uci.edu/index.html</a>
</div>


<script type="text/javascript" >
	$('#clearbtn').on('click', function() {
		$('#seqtext').val("");
	});

	$('#genbtn').on('click', function() {
		$('#seqtext').val(randSeq());
	});

	function randSeq() {
  		 var result           = '';
   		 var characters       = 'ACDEFGHIKLMNPQRSTVWY';
  		 var charactersLength = characters.length;
		 var length = Math.floor(Math.random() * 140) + 60 
   		 for ( var i = 0; i < length; i++ ) {
    		 	result += characters.charAt(Math.floor(Math.random() * charactersLength));
   		 }
   		 return result;
	}
	
	function checkCount()
	{
		checks = $('input[type="checkbox"]:checked').length;
		submit = document.getElementById('submitbtn');
		
		if(checks <= 0)
			submit.disabled = true;
		else
			submit.disabled = false;
	}
	
	
	// Display a message about color coding if user is using IE
	var ua = window.navigator.userAgent;
	var isIE = /MSIE|Trident/.test(ua);
	
	if(isIE)
	{
		ieDiv = document.getElementById("colorCodeIE");
		ieDiv.style.display = 'block';
	}
</script>
</body>
</html>